<template>
  <div class="fond">
    <div class="transition-container">
      <div class="texte" ref="texte">A giant world awaits</div>
      <div class="transition-img">
        <svg
          class="transition-svg-star"
          width="47"
          height="47"
          viewBox="0 0 47 47"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M23.9673 1.22714C23.8038 0.797709 23.1962 0.797711 23.0327 1.22714L17.0992 16.8098C17.0484 16.9431 16.9431 17.0484 16.8098 17.0992L1.22714 23.0327C0.79771 23.1962 0.79771 23.8038 1.22714 23.9673L16.8098 29.9008C16.9431 29.9516 17.0484 30.0569 17.0992 30.1902L23.0327 45.7729C23.1962 46.2023 23.8038 46.2023 23.9673 45.7729L29.9008 30.1902C29.9516 30.0569 30.0569 29.9516 30.1902 29.9008L45.7729 23.9673C46.2023 23.8038 46.2023 23.1962 45.7729 23.0327L30.1902 17.0992C30.0569 17.0484 29.9516 16.9431 29.9008 16.8098L23.9673 1.22714Z"
            fill="url(#paint0_radial_67_514)"
          />
          <defs>
            <radialGradient
              id="paint0_radial_67_514"
              cx="0"
              cy="0"
              r="1"
              gradientUnits="userSpaceOnUse"
              gradientTransform="translate(23.5 23.5) rotate(90) scale(42.0151)"
            >
              <stop stop-color="#828778" />
              <stop offset="1" stop-color="#919789" />
            </radialGradient>
          </defs>
        </svg>
      </div>
      <div class="star">
        <svg
          class="text-transition-svg-star star-01"
          width="47"
          height="47"
          viewBox="0 0 47 47"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M23.9673 1.22714C23.8038 0.797709 23.1962 0.797711 23.0327 1.22714L17.0992 16.8098C17.0484 16.9431 16.9431 17.0484 16.8098 17.0992L1.22714 23.0327C0.79771 23.1962 0.79771 23.8038 1.22714 23.9673L16.8098 29.9008C16.9431 29.9516 17.0484 30.0569 17.0992 30.1902L23.0327 45.7729C23.1962 46.2023 23.8038 46.2023 23.9673 45.7729L29.9008 30.1902C29.9516 30.0569 30.0569 29.9516 30.1902 29.9008L45.7729 23.9673C46.2023 23.8038 46.2023 23.1962 45.7729 23.0327L30.1902 17.0992C30.0569 17.0484 29.9516 16.9431 29.9008 16.8098L23.9673 1.22714Z"
            fill="url(#paint0_angular_67_514)"
          />
          <defs>
            <radialGradient
              id="paint0_angular_67_514"
              cx="0"
              cy="0"
              r="1"
              gradientUnits="userSpaceOnUse"
              gradientTransform="translate(23.5 23.5) rotate(90) scale(42.0151)"
            >
              <stop stop-color="#F5F0D5" />
              <stop offset="1" stop-color="white" />
            </radialGradient>
          </defs>
        </svg>
        <svg
          class="text-transition-svg-star star-02"
          width="47"
          height="47"
          viewBox="0 0 47 47"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M23.9673 1.22714C23.8038 0.797709 23.1962 0.797711 23.0327 1.22714L17.0992 16.8098C17.0484 16.9431 16.9431 17.0484 16.8098 17.0992L1.22714 23.0327C0.79771 23.1962 0.79771 23.8038 1.22714 23.9673L16.8098 29.9008C16.9431 29.9516 17.0484 30.0569 17.0992 30.1902L23.0327 45.7729C23.1962 46.2023 23.8038 46.2023 23.9673 45.7729L29.9008 30.1902C29.9516 30.0569 30.0569 29.9516 30.1902 29.9008L45.7729 23.9673C46.2023 23.8038 46.2023 23.1962 45.7729 23.0327L30.1902 17.0992C30.0569 17.0484 29.9516 16.9431 29.9008 16.8098L23.9673 1.22714Z"
            fill="url(#paint0_angular_67_514)"
          />
          <defs>
            <radialGradient
              id="paint0_angular_67_514"
              cx="0"
              cy="0"
              r="1"
              gradientUnits="userSpaceOnUse"
              gradientTransform="translate(23.5 23.5) rotate(90) scale(42.0151)"
            >
              <stop stop-color="#F5F0D5" />
              <stop offset="1" stop-color="white" />
            </radialGradient>
          </defs>
        </svg>
        <svg
          class="text-transition-svg-star star-03"
          width="47"
          height="47"
          viewBox="0 0 47 47"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M23.9673 1.22714C23.8038 0.797709 23.1962 0.797711 23.0327 1.22714L17.0992 16.8098C17.0484 16.9431 16.9431 17.0484 16.8098 17.0992L1.22714 23.0327C0.79771 23.1962 0.79771 23.8038 1.22714 23.9673L16.8098 29.9008C16.9431 29.9516 17.0484 30.0569 17.0992 30.1902L23.0327 45.7729C23.1962 46.2023 23.8038 46.2023 23.9673 45.7729L29.9008 30.1902C29.9516 30.0569 30.0569 29.9516 30.1902 29.9008L45.7729 23.9673C46.2023 23.8038 46.2023 23.1962 45.7729 23.0327L30.1902 17.0992C30.0569 17.0484 29.9516 16.9431 29.9008 16.8098L23.9673 1.22714Z"
            fill="url(#paint0_angular_67_514)"
          />
          <defs>
            <radialGradient
              id="paint0_angular_67_514"
              cx="0"
              cy="0"
              r="1"
              gradientUnits="userSpaceOnUse"
              gradientTransform="translate(23.5 23.5) rotate(90) scale(42.0151)"
            >
              <stop stop-color="#F5F0D5" />
              <stop offset="1" stop-color="white" />
            </radialGradient>
          </defs>
        </svg>
        <svg
          class="text-transition-svg-star star-04"
          width="47"
          height="47"
          viewBox="0 0 47 47"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M23.9673 1.22714C23.8038 0.797709 23.1962 0.797711 23.0327 1.22714L17.0992 16.8098C17.0484 16.9431 16.9431 17.0484 16.8098 17.0992L1.22714 23.0327C0.79771 23.1962 0.79771 23.8038 1.22714 23.9673L16.8098 29.9008C16.9431 29.9516 17.0484 30.0569 17.0992 30.1902L23.0327 45.7729C23.1962 46.2023 23.8038 46.2023 23.9673 45.7729L29.9008 30.1902C29.9516 30.0569 30.0569 29.9516 30.1902 29.9008L45.7729 23.9673C46.2023 23.8038 46.2023 23.1962 45.7729 23.0327L30.1902 17.0992C30.0569 17.0484 29.9516 16.9431 29.9008 16.8098L23.9673 1.22714Z"
            fill="url(#paint0_angular_67_514)"
          />
          <defs>
            <radialGradient
              id="paint0_angular_67_514"
              cx="0"
              cy="0"
              r="1"
              gradientUnits="userSpaceOnUse"
              gradientTransform="translate(23.5 23.5) rotate(90) scale(42.0151)"
            >
              <stop stop-color="#F5F0D5" />
              <stop offset="1" stop-color="white" />
            </radialGradient>
          </defs>
        </svg>
      </div>
    </div>
    <div class="scroll-svg-container">
      <svg
        class="scroll-down-svg"
        width="57"
        height="44"
        viewBox="0 0 57 44"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g filter="url(#filter0_d_122_6)">
          <path
            d="M48 9L29.3 33.9333C28.9 34.4667 28.1 34.4667 27.7 33.9333L9 9"
            stroke="url(#paint0_linear_122_6)"
            stroke-width="5"
            stroke-linecap="round"
          />
        </g>
        <defs>
          <filter
            id="filter0_d_122_6"
            x="-0.00012207"
            y="-0.000152588"
            width="57.0004"
            height="43.3335"
            filterUnits="userSpaceOnUse"
            color-interpolation-filters="sRGB"
          >
            <feFlood flood-opacity="0" result="BackgroundImageFix" />
            <feColorMatrix
              in="SourceAlpha"
              type="matrix"
              values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
              result="hardAlpha"
            />
            <feOffset />
            <feGaussianBlur stdDeviation="3.25" />
            <feComposite in2="hardAlpha" operator="out" />
            <feColorMatrix
              type="matrix"
              values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"
            />
            <feBlend
              mode="normal"
              in2="BackgroundImageFix"
              result="effect1_dropShadow_122_6"
            />
            <feBlend
              mode="normal"
              in="SourceGraphic"
              in2="effect1_dropShadow_122_6"
              result="shape"
            />
          </filter>
          <linearGradient
            id="paint0_linear_122_6"
            x1="28"
            y1="-80.5"
            x2="31"
            y2="107"
            gradientUnits="userSpaceOnUse"
          >
            <stop offset="0.494664" stop-color="#FFFFF7" />
            <stop offset="1" stop-color="#95AD8A" />
          </linearGradient>
        </defs>
      </svg>
    </div>
  </div>
</template>

<script>
import { gsap } from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";
import SplitText from "gsap/SplitText"; // Assurez-vous que SplitText est correctement importé

export default {
  mounted() {
    gsap.registerPlugin(ScrollTrigger, SplitText);
    this.worldTextTransition();
    // this.animateStars();
    this.stopStars();
  },

  methods: {
    worldTextTransition() {
      let mySplitText = new SplitText(this.$refs.texte, {
        type: "chars, words",
      });
      let chars = mySplitText.chars; // Array des caractères divisés pour l'animation

      gsap.to(".transition-img", {
        opacity: 0,
        duration: 1.5,
        delay: 5,
        onComplete: () => {
          this.stopStars();
        },
      });

      gsap.from(chars, {
        opacity: 0,
        duration: 1.2,
        stagger: 0.06,
        ease: "power1.out",
        onEnter: () => {
          // this.animateStars();
        },
      });
    },

    stopStars() {
      // gsap.to(".text-transition-svg-star", {
      //   duration: 1,
      //   opacity: 0,
      //   zIndex: 22222,
      //   ease: "power4.inOut",
      //   stagger: 0.3,
      // });

      gsap.to(".scroll-down-svg", {
        opacity: 1,
        duration: 0.8,
        top: "-66vh",
        zIndex: 222222,
      });
    },

    // animateStars() {
    //   gsap.to(".text-transition-svg-star", {
    //     duration: 1,
    //     opacity: 1,
    //     zIndex: 22222,
    //     ease: "power4.inOut",
    //     stagger: 0.3,
    //   });

    //   gsap.to(".transition-svg-star", {
    //     duration: 1.5,
    //     delay: 3,
    //     opacity: 0.8,
    //     scale: 0,
    //     rotate: 95,
    //     zIndex: 222222,
    //     ease: "power4.inOut",
    //   });
    // },
  },
};
</script>

<style scoped>
.fond {
  opacity: 1;
  width: 100vw;
  height: 100%;
  position: relative;
  z-index: -2;
  background-image: url("../assets/imgs/grosArbre.png");
  background-size: cover;
  background-repeat: no-repeat;
  background-position: top center;
}

.transition-container {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.transition-img {
  width: 100vw;
  height: 100%;
  position: relative;
  z-index: 200;
  background-color: "rgba(0, 0, 0, 0)";

  animation: gradient-animation 15s ease infinite;
}

@keyframes gradient-animation {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.transition-svg-star {
  width: 100%;
  height: 100%;
  position: absolute;
  top: -73vh;
  left: 0vw;
  scale: 1;
  scale: 3;
  opacity: 1;
  transform: rotate(0deg);
  z-index: 1000;
}

.texte {
  opacity: 1; /* Commencez invisible pour l'animation */
  font-size: 3em;
  color: #ffffea;
  position: relative;
  top: 20%;

  text-shadow: 0px 4px 20px rgba(0, 0, 0, 0.44);
  text-align: center;
  z-index: 1000;
}

.star-01 {
  width: 100%;
  height: 100%;
  position: absolute;
  top: -60vh;
  right: 20vw;
  scale: 0.04;
  z-index: 1000;
  animation: starsAnimation2 ease-in-out 2.5s infinite;
}
.star-02 {
  width: 100%;
  height: 100%;
  position: absolute;
  top: -80vh;
  scale: 0.03;
  right: -15vw;
  animation: starsAnimation2 ease-in-out 2s infinite;
  z-index: 1000;
}
.star-03 {
  width: 100%;
  height: 100%;
  position: absolute;
  top: -65vh;
  animation: starsAnimation ease-in-out 2s infinite;
  scale: 0.02;
  right: -22vw;

  z-index: 1000;
}
.star-04 {
  width: 100%;
  height: 100%;
  position: absolute;
  top: -85vh;
  scale: 0.02;
  right: 5vw;
  z-index: 1000;
  animation: starsAnimation ease-in-out 1.5s infinite;
}

.text-transition-svg-star {
  opacity: 0;
}

@keyframes starsAnimation {
  0% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(10vh);
  }
  100% {
    transform: translateY(0);
  }
}

@keyframes starsAnimation2 {
  0% {
    transform: translateY(15vh);
  }
  50% {
    transform: translateY(0);
  }
  100% {
    transform: translateY(15vh);
  }
}

.scroll-down-svg {
  width: 100%;
  height: 100%;
  z-index: 1000;
  opacity: 0;
  position: absolute;
  animation: starsAnimation ease-in-out 1.5s infinite;
  top: -67vh;
  scale: 0.02;
}
</style>
